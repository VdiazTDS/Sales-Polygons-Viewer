<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>TDS-PAK Sales Polygons Viewer</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

  <!-- App CSS -->
  <link rel="stylesheet" href="style.css" />

  <link rel="icon" href="favicon.ico" />
</head>

<body>
  <!-- ================= HEADER ================= -->
  <header>
    <h1>TDS-PAK Sales Polygons Viewer</h1>
    <p>Upload, manage, and visualize TDS-PAK sales polygon GeoJSON layers</p>
    <button id="mobileMenuBtn">‚ò∞ Menu</button>
  </header>

  <!-- ================= MAIN LAYOUT ================= -->
  <div class="app-container">

    <!-- Desktop sidebar collapse toggle -->
    <button id="toggleSidebarBtn" class="sidebar-toggle">‚ùÆ</button>

    <!-- ================= SIDEBAR ================= -->
    <aside class="sidebar">

      <!-- Upload -->
      <div id="dropZone">üìÇ Drag & drop GeoJSON or click to upload</div>

      <!-- Saved GeoJSON Layers -->
      <div class="filter-group">
        <strong>GeoJSON Layers</strong>
        <ul id="savedFiles"></ul>
      </div>

      <!-- Layer Instructions -->
      <div class="filter-group">
        <strong>How to Use</strong>
        <ul id="statsList">
          <li><b>Upload a file:</b> Drag and drop a .geojson/.json file into the upload box, or tap the box to choose a file from your device.</li>
          <li><b>Open an existing layer:</b> Click <b>Open</b> next to any saved file to display its polygons on the map.</li>
          <li><b>Change layer colors:</b> Use the color picker in the legend below the basemap selector to instantly update how each visible layer appears on the map.</li>
          <li><b>Reset Map View:</b> Click <b>Reset Map View</b> to zoom back out to the full world, remove all visible layers from the map, and clear the legend.</li>
          <li><b>Delete a file:</b> Click <b>Delete</b> to permanently remove a GeoJSON layer from storage.</li>
        </ul>
      </div>

      <!-- Reset Map -->
      <button id="resetMapBtn">Reset Map View</button>

      <!-- Basemap Selector -->
      <select id="baseMapSelect">
        <option value="streets">Streets</option>
        <option value="satellite">Satellite</option>
      </select>

      <!-- ================= LEGEND ================= -->
      <div id="mapLegend" class="map-legend" style="display:none; margin-top:10px;">
        <strong>Visible Layers</strong>
        <ul id="legendList"></ul>
      </div>

    </aside>

    <!-- ================= MAP ================= -->
    <main class="map-container">
      <div id="map"></div>

      <!-- ================= MAP LEGEND ================= -->
      <div id="mapLegend" class="map-legend" style="display:none;">
        <strong>Visible Layers</strong>
        <ul id="legendList"></ul>
      </div>
    </main>

  </div>

  <!-- ================= SCRIPTS ================= -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <!-- App JS -->
  <script src="app.js"></script>
</body>
</html>
